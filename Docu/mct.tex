\documentclass[11pt,a4paper,oneside,titlepage]{book}

\usepackage[english]{babel}
\usepackage{lineno,hyperref}
\usepackage[nolist]{acronym}
\usepackage[onehalfspacing]{setspace}
\usepackage{booktabs}
\usepackage{float}
\usepackage{amsmath}
\usepackage{listings}
\usepackage{color}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{blindtext}

\definecolor{LightGray}{gray}{0.70}
\lstdefinestyle{MctCpp}{%
    language=C++,
    keywordstyle=\bfseries,
    commentstyle=\itshape,
    rangeprefix=//--,rangesuffix=--,
    includerangemarker=false,
    columns=spaceflexible,
    escapeinside={/*@}{@*/},
    tabsize=4,
    frame=leftline,
    rulecolor=\color{LightGray},
    basicstyle=\ttfamily,
    numbers=left,
    numberstyle=\normalfont\tiny\color{LightGray},
    xleftmargin=0.75cm,
}

\lstdefinestyle{MctTxt}{%
    language={},
    keywordstyle=\bfseries,
    commentstyle=\itshape,
    rangeprefix=//--,rangesuffix=--,
    includerangemarker=false,
    columns=spaceflexible,
    escapeinside={/*@}{@*/},
    tabsize=4,
    frame=leftline,
    rulecolor=\color{LightGray},
    basicstyle=\ttfamily,
    numbers=left,
    numberstyle=\normalfont\tiny\color{LightGray},
    xleftmargin=0.75cm,
}


%\oddsidemargin = 31pt
%\topmargin = 20pt
%\headheight = 12pt
%\headsep = 25pt
\textheight = 25cm
\textwidth = 15cm
%\marginparsep = 10pt
%\marginparwidth = 35pt
%\footskip = 30pt

%\marginparpush = 7pt (not shown)
\hoffset = -1cm
\voffset = -2cm
%\paperwidth = 597pt
%\paperheight = 845pt


%\modulolinenumbers[1]

\begin{document}
%------------------------------------------------------------------------------
\newcommand{\CppFileStartEnd}[3]{%
    \begin{footnotesize}
        \lstinputlisting[linerange=#2-#3, style=MctCpp]{#1}%
    %\hfill\path{#1}\\
    \end{footnotesize}
}

\newcommand{\TxtFile}[1]{%
    \begin{footnotesize}
        \lstinputlisting[style=MctTxt]{#1}%
    \end{footnotesize}
}

\newcommand{\ill}[1]{% In Line Listing
    \begin{lstlisting}#1\end{lstlisting}    
}

\newcommand{\CenFig}[2]{
    \begin{figure}[H]
        \begin{center}
            \includegraphics[width=#2\textwidth]{#1}
        \end{center}
    \end{figure}
}

\makeatletter
\lst@Key{matchrangestart}{f}{\lstKV@SetIf{#1}\lst@ifmatchrangestart}
\def\lst@SkipToFirst{%
    \lst@ifmatchrangestart\c@lstnumber=\numexpr-1+\lst@firstline\fi
    \ifnum \lst@lineno<\lst@firstline
        \def\lst@next{\lst@BeginDropInput\lst@Pmode
        \lst@Let{13}\lst@MSkipToFirst
        \lst@Let{10}\lst@MSkipToFirst}%
        \expandafter\lst@next
    \else
        \expandafter\lst@BOLGobble
    \fi}
\makeatother
%------------------------------------------------------------------------------
\newcommand{\tool}{mctracer}
\newcommand{\thetitle}{\tool\\ \large{photon propagation in complex sceneries}}
%
\thispagestyle{empty}
\begin{center}
\Huge\textbf{\thetitle}
%
\vfill
%
\Large
mindset and how to use\\
\vspace{20pt}
\normalsize
{by\\\Large Sebastian Achim M\"uller } \\[5pt]
%
{\normalsize sebmuell@phys.ethz.ch}\\
%
\vspace{20pt}
Institute for Particle Physics
\par\smallskip\noindent
ETH Zurich\\2015-2017
\end{center}
%-------------------------------------------------------------
\pagenumbering{Roman}
\addcontentsline{toc}{chapter}{Contents}
\tableofcontents
%\newpage
%\addcontentsline{toc}{chapter}{Figures}
%\listoffigures
%\newpage
%\addcontentsline{toc}{chapter}{Tables}
%\listoftables
%-------------------------------------------------------------
\cleardoublepage
%
\setcounter{page}{0}
\pagenumbering{arabic}
%
\chapter{Abstract}
%
The \tool{} is a simulation for geometrical optics. 
%
It can propagate photons in a complex 3D scenery.
%
The \tool{} simulates reflection, refraction and absorbtion.
%
It does not cover diffraction.
%
For the investigation of optical devices or phenomena, \tool{} records the full photon's trajectory starting with the production, through all the photon's interactions until its final absorbtion.
%
A small set of primitiv surfaces is provided in \tool{} to form simple optical devices, such as lenses, imaging mirrors, light concentrators and aperture stops.
%
Further, complex objects can be simulated using triangular meshes.
%
To produce photons, \tool{} comes with a set of light sources to illuminate your scenery.
%
For more complex light sources, photons can be read from external files.
%
\tool{} can handle very complex sceneries with million of primitives while beeing fast and accurate on a scientific level.
%
You can feed your scenery into \tool{} using common CAD files for triangular meshes and a custom \tool{} xml file which describes the primitives provided by \tool{} itself.
%
When the provided tools do not cover your demand you have the chance to implement the features yourself.   
%
The \tool{} was originally created for simulations in Astro Particle Physics.
%
Imaging Atmospheric Cherenkov Telescopes like FACT and the CTA MST made use of \tool{} to investigate and improve their performance.
%
The \acf{acp} was born in this simulation.
%
\input{chapters/acp.tex}
\input{chapters/function.tex}
%-------------------------------------------------------------------------------
\chapter{How to set up a scenery in source code}
%
We will build a little scenery of a house with a roof and chimney as well as a simple tree. Further we add a small telescope with a reflective imaging mirror.
%
First we will define the geometry and their surfaces, second we will declare the relations between them. Third and finally we will update all frames relation w.r.t. the root frame to enable fast tracing (post initializing).
% 
%
First we define the main frame of our scenery. The main frame, often called world, will be the root of the scenery tree \ref{SubSecRootFrame}. 
%
\CppFileStartEnd{../Tests/Examples/set_up_scenery.cpp}{world}{tree}
%
Second we define frames that hold individual structures like a tree which will be composed from several objects. The tree will be placed in $x=5\,$m w.r.t. its later mother frame, i.e. the wolrd. 
%
\CppFileStartEnd{../Tests/Examples/set_up_scenery.cpp}{tree}{house}
Also part of the tree is the wooden pole.
\CppFileStartEnd{../Tests/Examples/set_up_scenery.cpp}{leaf_ball}{tree_pole}
and the rest of the source...
\CppFileStartEnd{../Tests/Examples/set_up_scenery.cpp}{tree_pole}{end_set_up_scene_in_source}
%------------------------------------------------------------------------------
%--references--
\renewcommand{\bibname}{References}
\bibliography{mct}
\bibliographystyle{plain}  
\addcontentsline{toc}{chapter}{\bibname}
%
\begin{acronym}
    \acro{mct}[MCt]{Monte Carlo Tracer}
    \acro{acp}[ACP]{Atmospheric Cherenkov Plenoscope}
    \acro{iact}[IACT]{Imaging Atmospheric Cherenkov Telescope}
    \acro{eas}[EAS]{Extensive Atmospheric Showers}
\end{acronym}
%--Appendix--
\end{document}